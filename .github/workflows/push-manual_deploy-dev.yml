name: 1 Deploy Develop ðŸš€

concurrency: develop

on:
  workflow_dispatch:  
  push:
    branches:
      - main
    
        
env:
  AMBIENTE: develop
  VERSION: ${{ github.sha }}

jobs:
  MuleDeploy:
    runs-on: ubuntu-22.04
    environment: develop
    steps:
    - uses: actions/checkout@v3
    - uses: actions/setup-java@v3
      with:
        distribution: 'temurin' # See 'Supported distributions' for available options
        java-version: '11'
    - uses: s4u/maven-settings-action@v2.6.0
      with:
        servers: '[{"id": "anypoint-exchange", "username": "~~~Client~~~", "password": "${{MULE_CLIENT_ID}}~?~${{MULE_CLIENT_SECRET}}"}]'
    - name: "Construir y Publicar"
      run: |
        mvn deploy
    - name: "Publicar en Exchange"
      run: mvn clean package deploy -Dclientid=${{MULE_CLIENT_ID}} -Dclientsecret=${{MULE_CLIENT_SECRET}} -DmuleDeploy
